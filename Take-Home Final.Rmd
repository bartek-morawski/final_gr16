---
title: "Take-Home Final"
author: "Bartlomiej Morawski"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1
```{r}
load("ThreeCancers.RData")

# (i)
num.of.subj <- nrow(GeneExp) # number of subjects in the matrix
num.of.subj

num.of.genes <- ncol(GeneExp)
num.of.genes

# (ii)
count <- 0
a <- 1
for (i in CancerType){
  if (CancerType[a] == "LUAD"){
    count <- count + 1
    }
  a <- a + 1
}
count

# (iii)
mean(GeneExp[,2])

# (iv)
library(ggplot2)
ggplot(data=GeneExp, mapping=aes(x=GeneExp$Gene45, y=GeneExp$Gene68)) +
geom_point()

# (v)
cor.test(GeneExp$Gene45, GeneExp$Gene68)

```

## Problem 2

(i) Make a box plot of Gene15 vs CancerType and pass it the following arguemnts: col = c("red", "green", "blue") and ylab = "Gene15"
```{r}
plot(CancerType, GeneExp$Gene15, col = c("red", "green", "blue"), ylab = "Gene 15")
```

(ii) What does the red box represent?

The red box represents the correlation between the expression of gene 15 in the subjects and the subjects with BRCA cancer. 

(iii) Which cancer type(s) have outliers

Cancer's BRCA and KIRC have outliers.

(iv) Which cancer type has the smallest median expression level?

Cancer KIRC has the smallest median expression level. 


## Problem 3
```{r}
# (i)

y <- as.numeric(CancerType == 'KIRC')
x <- GeneExp$Gene15

df <- data.frame(list(explanatory = x, observed_val = y))

fit <- lm(formula = observed_val ~ explanatory, data = df)
summary(fit) 

# (ii)
# a) The estimated coefficant is -0.073684 
# b) the p value associated with the coefficiant for Gene15 is  1.1*10^-15
# c) The p-values for the null hypotheis that the corresponding coefficient is zero.
# d) we can conclude that the coefficients you get estimates the standard errors, t-values and p-values

# (iii)
# the following code gives us the linear function
# β0 is the unknown intercept which is 5
# β1 the unknown slope  which is 2
x = seq(0, 10, by = 0.5)
beta0 = 5
beta1 = 2
y = beta0 + beta1 * x 
plot(x, y)
lines(x, y, col='blue')
```








## Problem 5
```{r}
# (i)
GeneExp.dist = dist(x = GeneExp[(1:10),], method = "euclidean")

# (ii)
gene.hclust = hclust(d = GeneExp.dist, method = "complete")

# (iii)
GeneExp.dist.mat <- as.matrix(GeneExp.dist)

# (iv)
# The Euclidean distance between subjects on and two is 18.08654
GeneExp.dist.mat[1,2]

# (v)
x <- GeneExp[1,]
y <- GeneExp[2,]

dist <- x-y
dist <- dist^2
dist <- sum(dist)
dist <- sqrt(dist)
dist

# (vi) Which subject has the smallest distance to Subject5?
# Subject 9 has the smallest distance to subject 5, measured at 7.784195.
x <- as.vector(GeneExp.dist.mat[,5])
x2 <- x[-5]
min(x2)

# (vii)
# some other linkage criteria include single-linkage and weighted or weighted average linkage clustering.

# (vii)
# The distance is 17.99
max(17.99, 16.95) 
```

